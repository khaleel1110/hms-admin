
<main id="content" role="main" class="main" style="min-height: 88vh">
  <div class="content container px-6">
    <div class="mb-4">
      <div class="row align-items-center">
        <div class="col-sm mb-2 mb-sm-0">
          <h1 class="page-header-title">Bookings List</h1>
          <p>View and manage all your bookings</p>
        </div>
        <div class="col-sm-auto">
          <a routerLink="/admin/add-booking" routerLinkActive="active" class="btn btn-outline-primary">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="20"
              fill="currentColor"
              class="bi bi-person-add"
              viewBox="0 0 16 16"
            >
              <path
                d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m.5-5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 1 0m-2-6a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4"
              />
              <path
                d="M8.256 14a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"
              />
            </svg>
            <span class="m-2">Add Booking</span>
          </a>
        </div>
      </div>
    </div>



    <div class="card shadow-none p-3">
      <div class="card-header card-header-content-md-between">
        <div class="col-sm-auto m-3">
          <form (ngSubmit)="onSearch()">
            <div class="input-group input-group-merge input-group-flush">
              <div class="input-group-prepend input-group-text">
                <i class="bi bi-search"></i>
              </div>
              <input
                id="datatableSearch"
                type="search"
                class="form-control"
                placeholder="Search bookings"
                aria-label="Search bookings"
                [(ngModel)]="searchTerm"
                name="searchTerm"
              />
              <button type="submit" class="btn btn-outline-primary">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  fill="currentColor"
                  class="bi bi-search"
                  viewBox="0 0 16 16"
                >
                  <path
                    d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"
                  />
                </svg>
                Search
              </button>
            </div>
          </form>
          <div *ngIf="selectedCount > 0" class="mt-3">
            <strong>{{ selectedCount }}</strong> Booking(s) selected.
          </div>
        </div>
        <div class="d-grid d-sm-flex justify-content-md-end align-items-sm-center gap-2">
          <!-- Export Dropdown -->
          <div class="dropdown" ngbDropdown #dropLearning="ngbDropdown">
            <button
              class="btn btn-white btn-sm w-100 dropdown-toggle"
              ngbDropdownAnchor
              (focus)="dropLearning.open()"
              role="button"
              id="usersExportDropdown"
              aria-expanded="false"
            >
              <i class="bi-download me-2"></i> Export
            </button>
            <div
              class="dropdown-menu dropdown-menu-sm-end"
              ngbDropdownMenu
              aria-labelledby="usersExportDropdown"
            >
              <span class="dropdown-header">Options</span>
              <a id="export-copy" class="dropdown-item" ngbDropdownItem href="javascript:;">
                <img
                  class="avatar avatar-xss avatar-4x3 me-2"
                  src="/assets/svg/illustrations/copy-icon.svg"
                  alt="Image Description"
                />
                Copy
              </a>
              <a id="export-print" class="dropdown-item" ngbDropdownItem href="javascript:;">
                <img
                  class="avatar avatar-xss avatar-4x3 me-2"
                  src="/assets/svg/illustrations/print-icon.svg"
                  alt="Image Description"
                />
                Print
              </a>
              <div class="dropdown-divider"></div>
              <span class="dropdown-header">Download options</span>
              <a id="export-excel" class="dropdown-item" ngbDropdownItem href="javascript:;">
                <img
                  class="avatar avatar-xss avatar-4x3 me-2"
                  src="/assets/svg/brands/excel-icon.svg"
                  alt="Image Description"
                />
                Excel
              </a>
              <a id="export-csv" class="dropdown-item" ngbDropdownItem href="javascript:;">
                <img
                  class="avatar avatar-xss avatar-4x3 me-2"
                  src="/assets/svg/components/placeholder-csv-format.svg"
                  alt="Image Description"
                />
                .CSV
              </a>
              <a id="export-pdf" class="dropdown-item" ngbDropdownItem href="javascript:;">
                <img
                  class="avatar avatar-xss avatar-4x3 me-2"
                  src="/assets/svg/brands/pdf-icon.svg"
                  alt="Image Description"
                />
                PDF
              </a>
            </div>
          </div>

          <!-- Filter Dropdown -->
          <div class="dropdown" ngbDropdown #dropFilter="ngbDropdown">
            <button
              class="btn btn-white btn-sm w-100 dropdown-toggle"
              ngbDropdownAnchor
              (focus)="dropFilter.open()"
              role="button"
              id="usersFilterDropdown"
              aria-expanded="false"
            >
              <i class="bi-filter me-1"></i> Filter
              <span class="badge bg-soft-dark text-dark rounded-circle ms-1">2</span>
            </button>
            <div
              class="dropdown-menu dropdown-menu-sm-end"
              ngbDropdownMenu
              aria-labelledby="usersFilterDropdown"
              style="min-width: 22rem;"
            >
              <div class="card">
                <div class="card-header card-header-content-between">
                  <h5 class="card-header-title">Filter users</h5>
                  <button type="button" class="btn btn-ghost-secondary btn-icon btn-sm ms-2">
                    <i class="bi-x-lg"></i>
                  </button>
                </div>
                <div class="card-body">
                  <form>
                    <div class="mb-4">
                      <small class="text-cap text-body">Role</small>
                      <div class="row">
                        <div class="col">
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value=""
                              id="usersFilterCheckAll"
                              checked
                            />
                            <label class="form-check-label" for="usersFilterCheckAll">All</label>
                          </div>
                        </div>
                        <div class="col">
                          <div class="form-check">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              value=""
                              id="usersFilterCheckEmployee"
                            />
                            <label class="form-check-label" for="usersFilterCheckEmployee">Employee</label>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-sm mb-4">
                        <small class="text-cap text-body">Position</small>
                        <div class="tom-select-custom">
                          <select
                            class="js-select js-datatable-filter form-select form-select-sm"
                            data-target-column-index="2"
                            data-hs-tom-select-options='{
                                "placeholder": "Any",
                                "searchInDropdown": false,
                                "hideSearch": true,
                                "dropdownWidth": "10rem"
                              }'
                          >
                            <option value="">Any</option>
                            <option value="Accountant">Accountant</option>
                            <option value="Co-founder">Co-founder</option>
                            <option value="Designer">Designer</option>
                            <option value="Developer">Developer</option>
                            <option value="Director">Director</option>
                          </select>
                        </div>
                      </div>
                      <div class="col-sm mb-4">
                        <small class="text-cap text-body">Status</small>
                        <div class="tom-select-custom">
                          <select
                            class="js-select js-datatable-filter form-select form-select-sm"
                            data-target-column-index="4"
                            data-hs-tom-select-options='{
                                "placeholder": "Any status",
                                "searchInDropdown": false,
                                "hideSearch": true,
                                "dropdownWidth": "10rem"
                              }'
                          >
                            <option value="">Any status</option>
                            <option
                              value="Completed"
                              data-option-template='<span class="d-flex align-items-center"><span class="legend-indicator bg-success"></span>Completed</span>'
                            >
                              Completed
                            </option>
                            <option
                              value="In progress"
                              data-option-template='<span class="d-flex align-items-center"><span class="legend-indicator bg-warning"></span>In progress</span>'
                            >
                              In progress
                            </option>
                            <option
                              value="To do"
                              data-option-template='<span class="d-flex align-items-center"><span class="legend-indicator bg-danger"></span>To do</span>'
                            >
                              To do
                            </option>
                          </select>
                        </div>
                      </div>
                      <div class="col-12 mb-4">
                        <span class="text-cap text-body">Location</span>
                        <div class="tom-select-custom">
                          <select class="js-select form-select">
                            <option
                              value="GB"
                              selected
                              data-option-template='<span class="d-flex align-items-center"><img class="avatar avatar-xss avatar-circle me-2" src="/assets/flags/gb.svg" alt="United Kingdom Flag" /><span class="text-truncate">United Kingdom</span></span>'
                            >
                              United Kingdom
                            </option>
                            <option
                              value="US"
                              data-option-template='<span class="d-flex align-items-center"><img class="avatar avatar-xss avatar-circle me-2" src="/assets/flags/us.svg" alt="United States Flag" /><span class="text-truncate">United States</span></span>'
                            >
                              United States
                            </option>
                          </select>
                        </div>
                      </div>
                    </div>
                    <div class="d-grid">
                      <a class="btn btn-primary" href="javascript:;">Apply</a>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
          <!-- End Filter Dropdown -->
        </div>
      </div>


      <div class="table-responsive datatable-custom position-relative">
        <div *ngIf="isLoading()" class="text-center p-4">
          <div class="spinner-border" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>

        <table
          *ngIf="!isLoading()"
          class="table table-lg table-borderless table-thead-bordered table-nowrap table-align-middle card-table"
          data-hs-datatables-options='{
            "columnDefs": [{
              "targets": [0, 8],
              "orderable": false
            }],
            "order": [],
            "info": {
              "totalQty": "#datatableWithPaginationInfoTotalQty"
            },
            "search": "#datatableSearch",
            "entries": "#datatableEntries",
            "pageLength": 15,
            "isResponsive": false,
            "isShowPaging": false,
            "pagination": "datatablePagination"
          }'
        >
          <thead class="thead-light">
          <tr>
            <th class="table-column-pe-0">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value=""
                  id="datatableCheckAll"
                  (change)="selectAll($event)"
                />
                <label class="form-check-label" for="datatableCheckAll"></label>
              </div>
            </th>
            <th scope="col"><strong class="h4">S/N</strong></th>
            <th scope="col"><strong class="h4">Patient Name</strong></th>
            <th scope="col"><strong class="h4">Doctor</strong></th>
            <th scope="col"><strong class="h4">Phone</strong></th>
            <th scope="col"><strong class="h4">Appointment Type</strong></th>
            <th scope="col"><strong class="h4">Time</strong></th>
            <th scope="col"><strong class="h4">Edit</strong></th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let booking of bookingsItems; let i = index">
            <td class="table-column-pe-0">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value=""
                  [checked]="isSelected(booking.id)"
                  (change)="toggleSelection(booking.id)"
                />
                <label class="form-check-label" for="datatableCheckAll{{i}}"></label>
              </div>
            </td>
            <td>{{ (currentPage - 1) * itemsPerPage + i + 1 }}</td>
            <td class="table-column-ps-0">
              <a class="d-flex align-items-center" >
                <div class="avatar avatar-soft-dark avatar-circle">
              <span class="avatar-initials">{{
                  booking.name
                    ? booking.email.substring(0, 2).toUpperCase()
                    : 'UN'
                }}</span>
                </div>
                <div class="ms-3">
                  <span class="d-block h5 text-inherit mb-0">{{ booking.name }}</span>
                  <span class="d-block fs-5 text-body">{{ booking.email || 'N/A' }}</span>
                </div>
              </a>
            </td>
            <td>dr.{{ booking.doctorName }}</td>
            <td>{{ booking.phone }}</td>
            <td>{{ booking.appointmentType }}</td>
            <td>{{ booking.startTime | date: 'shortTime' }} - {{ booking.endTime | date: 'shortTime' }}</td>
            <td>
              <a
                [routerLink]="['/admin/view-booking', booking.id]"
                routerLinkActive="active"
                class="btn btn-sm btn-outline-primary"
              >
              Edit
              </a>
            </td>
          </tr>
          </tbody>
        </table>
      </div>


    </div>
    <div class="p-4">
      <app-pagination
        [totalItems]="bookings().length"
        [itemsPerPage]="itemsPerPage"
        [currentPage]="currentPage"
        (pageChange)="onPageChange($event)"
      ></app-pagination>
    </div>
  </div>
</main>

