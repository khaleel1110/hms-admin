
<main id="content" role="main" class="main" style="min-height: 88vh">
  <div class="content container px-6">
    <div class="mb-4">
      <div class="row align-items-center">
        <div class="col-sm mb-2 mb-sm-0">
          <h1 class="page-header-title">Bookings List</h1>
          <p>View and manage all your bookings</p>
        </div>
        <div class="col-sm-auto">
          <a routerLink="/admin/add-booking" routerLinkActive="active" class="btn btn-outline-primary">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="20"
              fill="currentColor"
              class="bi bi-person-add"
              viewBox="0 0 16 16"
            >
              <path
                d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m.5-5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 1 0m-2-6a3 3 0 1 1-6 0 3 3 0 0 1 6 0M8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4"
              />
              <path
                d="M8.256 14a4.5 4.5 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10q.39 0 .74.025c.226-.341.496-.65.804-.918Q8.844 9.002 8 9c-5 0-6 3-6 4s1 1 1 1z"
              />
            </svg>
            <span class="m-2">Add Booking</span>
          </a>
        </div>
      </div>
    </div>

    <div class="row align-items-end">
      <div class="col-sm mb-2 mb-sm-0"></div>
      <div class="col-sm-auto m-3">
        <form (ngSubmit)="onSearch()">
          <div class="input-group input-group-merge input-group-flush">
            <div class="input-group-prepend input-group-text">
              <i class="bi bi-search"></i>
            </div>
            <input
              id="datatableSearch"
              type="search"
              class="form-control"
              placeholder="Search bookings"
              aria-label="Search bookings"
              [(ngModel)]="searchTerm"
              name="searchTerm"
            />
            <button type="submit" class="btn btn-outline-primary">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="currentColor"
                class="bi bi-search"
                viewBox="0 0 16 16"
              >
                <path
                  d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"
                />
              </svg>
              Search
            </button>
          </div>
        </form>
        <div *ngIf="selectedCount > 0" class="mt-3">
          <strong>{{ selectedCount }}</strong> Booking(s) selected.
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header card-header-content-md-between">
        <div class="mb-2 mb-md-0"></div>
        <div class="d-grid d-sm-flex justify-content-md-end align-items-sm-center gap-2">
          <div class="dropdown">
            <button
              class="btn btn-white btn-sm dropdown-toggle w-100"
              data-bs-toggle="dropdown"
              aria-expanded="false"
            >
              Export
            </button>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">Export as CSV</a></li>
              <li><a class="dropdown-item" href="#">Export as PDF</a></li>
            </ul>
          </div>
          <div class="dropdown">
            <button
              type="button"
              class="btn btn-white btn-sm w-100"
              id="bookingsFilterDropdown"
              data-bs-toggle="dropdown"
              data-bs-auto-close="outside"
              aria-expanded="false"
            >
              <i class="bi-filter me-1"></i> Filter
              <span class="badge bg-soft-dark text-dark rounded-circle ms-1">2</span>
            </button>
            <div
              class="dropdown-menu dropdown-menu-sm-end dropdown-card card-dropdown-filter-centered"
              aria-labelledby="bookingsFilterDropdown"
              style="min-width: 22rem;"
            >
              <div class="card">
                <div class="card-header card-header-content-between">
                  <h5 class="card-header-title">Filter bookings</h5>
                  <button type="button" class="btn btn-ghost-secondary btn-icon btn-sm ms-2">
                    <i class="bi-x-lg"></i>
                  </button>
                </div>
                <div class="card-body">
                  <!-- Add filter options here -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="table-responsive datatable-custom position-relative">
        <div *ngIf="isLoading()" class="text-center p-4">
          <div class="spinner-border" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>

        <table
          *ngIf="!isLoading()"
          class="table table-lg table-borderless table-thead-bordered table-nowrap table-align-middle card-table"
          data-hs-datatables-options='{
            "columnDefs": [{
              "targets": [0, 8],
              "orderable": false
            }],
            "order": [],
            "info": {
              "totalQty": "#datatableWithPaginationInfoTotalQty"
            },
            "search": "#datatableSearch",
            "entries": "#datatableEntries",
            "pageLength": 15,
            "isResponsive": false,
            "isShowPaging": false,
            "pagination": "datatablePagination"
          }'
        >
          <thead class="thead-light">
          <tr>
            <th class="table-column-pe-0">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value=""
                  id="datatableCheckAll"
                  (change)="selectAll($event)"
                />
                <label class="form-check-label" for="datatableCheckAll"></label>
              </div>
            </th>
            <th scope="col"><strong class="h4">S/N</strong></th>
            <th scope="col"><strong class="h4">Patient Name</strong></th>
            <th scope="col"><strong class="h4">Doctor</strong></th>
            <th scope="col"><strong class="h4">Email</strong></th>
            <th scope="col"><strong class="h4">Phone</strong></th>
            <th scope="col"><strong class="h4">Department</strong></th>
            <th scope="col"><strong class="h4">Time</strong></th>
            <th scope="col"><strong class="h4">Edit</strong></th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let booking of bookingsItems; let i = index">
            <td class="table-column-pe-0">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  value=""
                  [checked]="isSelected(booking.id)"
                  (change)="toggleSelection(booking.id)"
                />
                <label class="form-check-label" for="datatableCheckAll{{i}}"></label>
              </div>
            </td>
            <td>{{ (currentPage - 1) * itemsPerPage + i + 1 }}</td>
            <td>{{ booking.patientName }}</td>
            <td>{{ booking.doctorName }}</td>
            <td>{{ booking.email }}</td>
            <td>{{ booking.phone }}</td>
            <td>{{ booking.departmentName }}</td>
            <td>{{ booking.startTime | date: 'shortTime' }} - {{ booking.endTime | date: 'shortTime' }}</td>
            <td>
              <a
                [routerLink]="['/admin/edit-booking', booking.id]"
                routerLinkActive="active"
                class="btn btn-sm btn-outline-primary"
              >
                View
              </a>
            </td>
          </tr>
          </tbody>
        </table>
      </div>

      <div class="p-4">
        <app-pagination
          [totalItems]="bookings().length"
          [itemsPerPage]="itemsPerPage"
          [currentPage]="currentPage"
          (pageChange)="onPageChange($event)"
        ></app-pagination>
      </div>
    </div>
  </div>
</main>

